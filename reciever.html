<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>sample1</title>
</head>
<body>
  <p>あなたの PeerID： <span id="peerid"></span></p>
  <div>
    接続先 PeerID： <input type="text" id="connectId" name="peerid">
    <button type="button" onclick="connect()">接続</div>
  </div>
  <video id="local_video" autoplay style = "width : 900px; height : 600px;">
</body>
  <script src="https://unpkg.com/peerjs@1.3.1/dist/peerjs.min.js"></script>
  <script type="text/javascript">
    // PeerIDの表示
    var peer = new Peer();
    peer.on('open', function(id) {
      document.getElementById('peerid').textContent = id;
    });
    // 受信する
    peer.on('connection', function(conn) {
        conn.on('data',function(data) {
        // 受け取ったデータをコンソールログ出力
        console.log(data);
      });
    });
    // connectIdに送信する
    function connect() {
      connectId = document.getElementById("connectId").value;
      const conn = peer.connect(connectId);
      conn.on('open', function() {
        conn.on('data', function(data) {
          console.log('Received', data);
        });

        conn.send('Hello!');
      });
    };
    // ビデオ表示
    let localVideo = document.getElementById('local_video');
    navigator.mediaDevices.getUserMedia({video : true, audio : false})
    .then(function (stream) {
      localVideo.srcObject = stream;
    }).catch(function (error){
      console.error('mediaDevices.getUserMedia() error:', error);
      return;
    });
  </script>
</html>